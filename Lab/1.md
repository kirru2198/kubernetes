Tasks To Be Performed:
 1. Deploy a Kubernetes cluster for 3 nodes
 2. Create a NGINX deployment of 3 replicas

---
Here's a **detailed step-by-step guide** to complete your Kubernetes-based DevOps assignment:

---

## ğŸ§¾ **Assignment Breakdown**

### âœ… Task 1: Deploy a Kubernetes cluster with 3 nodes

### âœ… Task 2: Create a NGINX deployment with 3 replicas

---

## âœ… **Task 1: Deploy a Kubernetes Cluster with 3 Nodes**

You can deploy a 3-node Kubernetes cluster using:

* **Virtual machines (VMs)** with tools like VirtualBox, VMware, or cloud providers
* **kubeadm** (production-style installation)
* **Minikube with multi-node** (for testing)
* **Kind (Kubernetes in Docker)** (for learning & local testing)

Here, weâ€™ll use `**kubeadm**`, which is widely used for setting up real Kubernetes clusters.

---

### ğŸ”§ **System Requirements (for all 3 nodes)**

* OS: Ubuntu 20.04+ (or CentOS)
* 2 CPUs, 2 GB RAM minimum per node
* Docker or container runtime installed
* `kubeadm`, `kubelet`, and `kubectl` installed

Letâ€™s say:

* **Master Node IP**: `192.168.1.10`
* **Worker1 Node IP**: `192.168.1.11`
* **Worker2 Node IP**: `192.168.1.12`

---

### ğŸ› ï¸ **Step-by-Step Cluster Setup Using kubeadm**

#### ğŸ“Œ Step 1: Set up all nodes

On **all nodes**, install container runtime, kubelet, kubeadm, and kubectl.

```bash
# Update and install dependencies
sudo apt-get update && sudo apt-get install -y apt-transport-https curl

# Add Kubernetes GPG key and repo
curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add -
echo "deb https://apt.kubernetes.io/ kubernetes-xenial main" \
  | sudo tee /etc/apt/sources.list.d/kubernetes.list

# Install Docker (or containerd) and Kubernetes components
sudo apt-get update
sudo apt-get install -y docker.io kubelet kubeadm kubectl
sudo apt-mark hold kubelet kubeadm kubectl
```

Disable swap on **all nodes**:

```bash
sudo swapoff -a
sudo sed -i '/ swap / s/^/#/' /etc/fstab
```

---

#### ğŸ“Œ Step 2: Initialize the Kubernetes cluster on the master node

On the **master node** (`192.168.1.10`):

```bash
sudo kubeadm init --pod-network-cidr=192.168.0.0/16
```

After initialization, set up `kubectl`:

```bash
mkdir -p $HOME/.kube
sudo cp /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $(id -u):$(id -g) $HOME/.kube/config
```

---

#### ğŸ“Œ Step 3: Install a Pod network (Calico or Flannel)

```bash
kubectl apply -f https://raw.githubusercontent.com/projectcalico/calico/v3.26.1/manifests/calico.yaml
```

---

#### ğŸ“Œ Step 4: Join the worker nodes to the cluster

From the output of `kubeadm init`, you'll get a join command like this:

```bash
kubeadm join 192.168.1.10:6443 --token abcdef.0123456789abcdef \
  --discovery-token-ca-cert-hash sha256:xxxxxxxxxxxxxxxxxxxxxxxx
```

Run the above command on **worker1 and worker2**.

---

#### ğŸ“Œ Step 5: Verify Cluster

On the **master node**, run:

```bash
kubectl get nodes
```

You should see 3 nodes: `master`, `worker1`, and `worker2`, all in `Ready` state.

---

## âœ… **Task 2: Create a NGINX Deployment with 3 Replicas**

---

### ğŸ› ï¸ Step-by-Step: Deploy NGINX

#### ğŸ“Œ Step 1: Create a Deployment YAML file

Create a file called `nginx-deployment.yaml`:

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:latest
        ports:
        - containerPort: 80
```

#### ğŸ“Œ Step 2: Apply the deployment

```bash
kubectl apply -f nginx-deployment.yaml
```

---

#### ğŸ“Œ Step 3: Verify the deployment

```bash
kubectl get deployments
kubectl get pods -o wide
```

You should see 3 NGINX pods running across your nodes.

---

#### ğŸ“Œ Step 4: Expose the Deployment (Optional)

To access it from outside the cluster:

```bash
kubectl expose deployment nginx-deployment --type=NodePort --port=80
```

Then run:

```bash
kubectl get svc
```

Youâ€™ll get a port like `:300XX`. Access NGINX from any node IP like:
ğŸ‘‰ `http://<any-node-ip>:300XX`

---

## âœ… Summary of Key Commands

### Kubernetes Setup:

```bash
# Master node
sudo kubeadm init --pod-network-cidr=192.168.0.0/16
kubectl apply -f calico.yaml

# Workers
kubeadm join <master-ip>:6443 --token <token> --discovery-token-ca-cert-hash <hash>

# Verify
kubectl get nodes
```

### NGINX Deployment:

```bash
kubectl apply -f nginx-deployment.yaml
kubectl get pods
kubectl expose deployment nginx-deployment --type=NodePort --port=80
```

---
